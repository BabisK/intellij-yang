buildscript {
    repositories {
        jcenter()
        mavenCentral()
    }
}

plugins {
    id "org.jetbrains.intellij" version "0.3.0"
}

allprojects {
    apply plugin: 'java'
    apply plugin: 'groovy'

    apply from: 'gradle/markdown.gradle'
    sourceCompatibility = javaVersion
    targetCompatibility = javaTargetVersion
    tasks.withType(JavaCompile) { options.encoding = 'UTF-8' }

    sourceSets {
        main {
            java.srcDirs 'gen', 'src/main/java'
            resources.srcDirs 'resources'
        }
    }

    apply plugin: 'org.jetbrains.intellij'
    intellij {
        version ideaVersion
        pluginName 'intellij-yang'
        downloadSources Boolean.valueOf(sources)
        sameSinceUntilBuild Boolean.valueOf(isEAP)
    }

    patchPluginXml {
        changeNotes mdToHtml('CHANGELOG.md')
    }
}

group 'org.jetbrains'
version = "${version}.$buildNumber"
apply plugin: 'idea'
idea {
    project {
        jdkName = javaVersion
        languageLevel = javaVersion
        vcs = 'Git'
    }

    module {
        generatedSourceDirs += file('gen')
    }
}